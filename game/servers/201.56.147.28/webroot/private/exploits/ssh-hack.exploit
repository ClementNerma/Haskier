REFERER: ssh-sdfmlkSDF8FQD50sdfSF8sd5fSZER855
HELP => IP "Distant server adress", USER "(Optionnal) Name of the account to hack", SSH "(Optionnal) Auto-SSH connect if hack success"
load_ssh();

if(ss[vars.IP].outside.length)
  error('Server has too many securities to be hacked');
endif

srv = servers[vars.IP];

display('Retrieving data...', 500);
display('Communication encryption... AES (1/2)', 1000);
display('Communication encryption... RSA (1/2)', 1000);
display(' ');

if(vars.USER)
  if(!srv.hasUser(vars.USER) or srv.checkUserLevel(user, 'system'))
    error('Failed to get credentials for user "' + vars.USER + '"');
  endif

  user = vars.USER;
  pass = srv.user(vars.USER).password;
else
  user = srv.usersByRight('guest')[0];

  if(!user)
    error('There is nothing to hack on this server');
  endif

  pass = srv.user(user).password;
endif

if(!vars.SSH)
  display('=== Credentials ===');
  display('Username : ' + user);
  display('Password : ' + pass);
  display('======= End =======');
else
  display('Logging as ' + user + '...', 1000);
  save.data.me_agent.push(vars.IP); |;
  log_ssh(vars.IP, user); |;
  display('Success ! You\'ve been logged in as ' + user);
  masterCommand = function(cmd) { return cmd.$ === 'metacl' ? $MetaCl : false; };
endif

exit(0);
